<!DOCTYPE html>
<html>
<head>
  <title>Ganesh Billing Login</title>
</head>
<body>

<h2>Register</h2>
<input id="r_name" placeholder="Name"><br>
<input id="r_mobile" placeholder="Mobile"><br>
<input id="r_password" type="password" placeholder="Password"><br>
<button onclick="register()">Register</button>

<hr>

<h2>Login</h2>
<input id="l_mobile" placeholder="Mobile"><br>
<input id="l_password" type="password" placeholder="Password"><br>
<button onclick="login()">Login</button>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getFirestore, doc, setDoc, getDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyAY4MfQ5zPh60EfYmY0JoKIDQkojqNU6hs",
  authDomain: "ganeshbilling-bdada.firebaseapp.com",
  projectId: "ganeshbilling-bdada",
  storageBucket: "ganeshbilling-bdada.firebasestorage.app",
  messagingSenderId: "351410373004",
  appId: "1:351410373004:web:50be765037e463735a16a9"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

// REGISTER
window.register = async function () {
  const name = r_name.value;
  const mobile = r_mobile.value;
  const password = r_password.value;

  if (!name || !mobile || !password) {
    alert("All fields required");
    return;
  }

  await setDoc(doc(db, "users", mobile), {
    name,
    mobile,
    password
  });

  alert("Registered Successfully");
};

// LOGIN
window.login = async function () {
  const mobile = l_mobile.value;
  const password = l_password.value;

  const userRef = doc(db, "users", mobile);
  const userSnap = await getDoc(userRef);

  if (!userSnap.exists()) {
    alert("User not found");
    return;
  }

  if (userSnap.data().password !== password) {
    alert("Wrong password");
    return;
  }

  alert("Login Successful");
};
</script>

</body>
</html>
